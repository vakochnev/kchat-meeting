# KChat Meeting - –ë–æ—Ç –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —Å–æ–≤–µ—â–∞–Ω–∏–π

–ë–æ—Ç –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —Å–æ–≤–µ—â–∞–Ω–∏–π –≤ KChat. –°–æ–±–∏—Ä–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ SSE —Å–æ–±—ã—Ç–∏–π, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ–ø—É—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç–≤–µ—Ç—ã –Ω–∞ –±—ç–∫–µ–Ω–¥.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìÖ **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–≤–µ—â–∞–Ω–∏—è–º–∏:**
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–ø—É—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫ —Å–æ–≤–µ—â–∞–Ω–∏—é
  - –û–ø—Ä–æ—Å –æ –ø–ª–∞–Ω–∏—Ä—É–µ–º–æ–º –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–∏
  - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤ –≤ –ë–î

- üîÑ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å SSE:**
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ —Å–æ–±—ã—Ç–∏–π
  - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ —Ç–∞–±–ª–∏—Ü—É `invited`

- üíæ **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:**
  - SQLite/PostgreSQL
  - –¢–∞–±–ª–∏—Ü–∞ `invited` ‚Äî —Å–ø–∏—Å–æ–∫ –ø—Ä–∏–≥–ª–∞—à—ë–Ω–Ω—ã—Ö –∏ –æ—Ç–≤–µ—Ç—ã –æ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–∏

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.11+
- [uv](https://github.com/astral-sh/uv) - –±—ã—Å—Ç—Ä—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –ø–∞–∫–µ—Ç–æ–≤ Python

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ uv

```bash
# Linux/macOS
curl -LsSf https://astral.sh/uv/install.sh | sh

# Windows
powershell -c "irm https://astral.sh/uv/install.ps1 | iex"
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
cd /home/wka/code/kchat-meeting

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (–≤–∫–ª—é—á–∞—è –ª–æ–∫–∞–ª—å–Ω—ã–π wheel —Ñ–∞–π–ª)
uv sync
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env`:

```ini
BOT_TOKEN=your_bot_token_here
API_BASE_URL=https://api.kchat.app
SSE_BASE_URL=https://pusher.kchat.app
DATABASE_URL=sqlite:///meetings.db
LOG_LEVEL=INFO
```

### 4. –ó–∞–ø—É—Å–∫

```bash
uv run python main.py
```

## –†–∞–±–æ—Ç–∞ —Å uv

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
uv sync

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
uv add package-name

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ dev –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
uv add --dev pytest

# –ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞
uv run python main.py

# –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
source .venv/bin/activate  # Linux/macOS
.venv\Scripts\activate     # Windows
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
kchat-opros/
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îî‚îÄ‚îÄ surveys/              # JSON-—Ñ–∞–π–ª—ã –æ–ø—Ä–æ—Å–æ–≤
‚îÇ       ‚îú‚îÄ‚îÄ survey_satisfaction.json
‚îÇ       ‚îî‚îÄ‚îÄ survey_feedback.json
‚îú‚îÄ‚îÄ modules/
‚îÇ   ‚îú‚îÄ‚îÄ core/                 # –Ø–¥—Ä–æ –±–æ—Ç–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ app.py           # –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ sse_handler.py   # –û–±—Ä–∞–±–æ—Ç—á–∏–∫ SSE
‚îÇ   ‚îú‚îÄ‚îÄ surveys/              # –õ–æ–≥–∏–∫–∞ –æ–ø—Ä–æ—Å–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config_manager.py # –ó–∞–≥—Ä—É–∑–∫–∞ JSON
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ handler.py       # –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ processor.py     # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ state.py         # –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ui.py            # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îÇ   ‚îî‚îÄ‚îÄ answers/              # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ç–∏–ø–æ–≤ –æ—Ç–≤–µ—Ç–æ–≤
‚îÇ       ‚îú‚îÄ‚îÄ choice.py
‚îÇ       ‚îú‚îÄ‚îÄ rating.py
‚îÇ       ‚îú‚îÄ‚îÄ text.py
‚îÇ       ‚îî‚îÄ‚îÄ yes_no.py
‚îú‚îÄ‚îÄ db/
‚îÇ   ‚îú‚îÄ‚îÄ models.py            # –ú–æ–¥–µ–ª–∏ SQLAlchemy
‚îÇ   ‚îú‚îÄ‚îÄ session.py           # –°–µ—Å—Å–∏—è –ë–î
‚îÇ   ‚îî‚îÄ‚îÄ storage.py           # –•—Ä–∞–Ω–∏–ª–∏—â–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
‚îú‚îÄ‚îÄ config.py                # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ main.py                  # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îî‚îÄ‚îÄ README.md
```

## –§–æ—Ä–º–∞—Ç JSON –æ–ø—Ä–æ—Å–∞

```json
{
  "survey_id": "my_survey",
  "name": "–ù–∞–∑–≤–∞–Ω–∏–µ –æ–ø—Ä–æ—Å–∞",
  "description": "–û–ø–∏—Å–∞–Ω–∏–µ",
  "welcome_message": "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ",
  "completion_message": "–°–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏",
  "questions": [
    {
      "id": "q1",
      "text": "–¢–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞",
      "type": "choice|rating|yes_no|text",
      "required": true,
      "hint": "–ü–æ–¥—Å–∫–∞–∑–∫–∞"
    }
  ]
}
```

### –¢–∏–ø—ã –≤–æ–ø—Ä–æ—Å–æ–≤

#### choice - –í—ã–±–æ—Ä –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤

```json
{
  "id": "q1",
  "text": "–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç",
  "type": "choice",
  "options": [
    {"value": "opt1", "label": "–í–∞—Ä–∏–∞–Ω—Ç 1"},
    {"value": "opt2", "label": "–í–∞—Ä–∏–∞–Ω—Ç 2"}
  ],
  "required": true
}
```

#### rating - –û—Ü–µ–Ω–∫–∞ –ø–æ —à–∫–∞–ª–µ

```json
{
  "id": "q2",
  "text": "–û—Ü–µ–Ω–∏—Ç–µ –æ—Ç 1 –¥–æ 5",
  "type": "rating",
  "min": 1,
  "max": 5,
  "labels": {
    "1": "üòû –ü–ª–æ—Ö–æ",
    "5": "üòä –û—Ç–ª–∏—á–Ω–æ"
  },
  "required": true
}
```

#### yes_no - –î–∞/–ù–µ—Ç

```json
{
  "id": "q3",
  "text": "–°–æ–≥–ª–∞—Å–Ω—ã –ª–∏ –≤—ã?",
  "type": "yes_no",
  "required": true
}
```

#### text - –°–≤–æ–±–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç

```json
{
  "id": "q4",
  "text": "–í–∞—à–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏",
  "type": "text",
  "required": false,
  "min_length": 0,
  "max_length": 1000,
  "hint": "–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç"
}
```

## –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/start` | –ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã |
| `/–æ–ø—Ä–æ—Å—ã` | –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –æ–ø—Ä–æ—Å–æ–≤ |
| `/–æ—Ç–º–µ–Ω–∞` | –û—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–π –æ–ø—Ä–æ—Å |
| `/–ø–æ–º–æ—â—å` | –°–ø—Ä–∞–≤–∫–∞ |

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –æ–ø—Ä–æ—Å–∞

1. –°–æ–∑–¥–∞–π—Ç–µ JSON —Ñ–∞–π–ª –≤ `config/surveys/`
2. –£–∫–∞–∂–∏—Ç–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π `survey_id`
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ –∏–ª–∏ –≤—ã–∑–æ–≤–∏—Ç–µ `config_manager.reload()`

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç–∏–ø–∞ –≤–æ–ø—Ä–æ—Å–∞

1. –°–æ–∑–¥–∞–π—Ç–µ –∫–ª–∞—Å—Å –≤ `modules/answers/`
2. –ù–∞—Å–ª–µ–¥—É–π—Ç–µ –æ—Ç `AnswerHandler`
3. –†–µ–∞–ª–∏–∑—É–π—Ç–µ –º–µ—Ç–æ–¥—ã `validate()`, `build_buttons()`
4. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –≤ `ANSWER_HANDLERS`

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT
